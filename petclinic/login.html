<!--
Author: W3layouts
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE HTML>
<html>
<head>
<title>虚拟宠物医院管理系统</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Modern Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template, 
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
 <!-- Bootstrap Core CSS -->
<link href="css/bootstrap.min.css" rel='stylesheet' type='text/css' />
<!-- Custom CSS -->
<link href="css/style.css" rel='stylesheet' type='text/css' />
<link href="css/font-awesome.css" rel="stylesheet"> 
<!-- jQuery -->
<script src="js/jquery.min.js"></script>
<!----webfonts--->
<link href='http://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,900' rel='stylesheet' type='text/css'>
<!---//webfonts--->  
<!-- Bootstrap Core JavaScript -->
<script src="js/bootstrap.min.js"></script>
<script type="text/javascript">
  base_url = "http://api.petclinic.com";
  $(document).ready(function(){
    $("#login_form").submit(function(){
      //禁用form默认提交，使用ajax提交
      return false;
    });
    $("#login_button").click(function(){
      //form的button真正触发事件
      username = $("#login_form").find("[name='username']").val();
      password = $("#login_form").find("[name='password']").val();
      is_manager = $("#login_form").find("input[name='is_manager']:checked").val() == "true";
      //for test
      if(username == "admin" || password == "admin"){
        alert("登陆成功");
        if(is_manager == false)
          location.href = "guide.html";
        else
          location.href = "usermanagement.html";
        return;
      }
      else{
        alert("用户名或密码错误");
        return;
      }
      if(username == "" || password == ""){
        alert("用户名或密码不能为空");
        return;
      }
      $.ajax({
        type: "POST",
        url: base_url + "/login",
        data: {username:username, password:password,is_manager:is_manager},
        dataType: "json",
        success: function(data){
                    switch(data.status){
                      case 200:
                        token = data.token;
                        alert("登陆成功");
                        if(is_manager == false)
                          location.href = "guide.html?&token="+token;
                        else
                          location.href = "usermanagement.html?&token="+token;
                        return;
                      case 401:
                        alert(data.message);
                        return;
                      case 0:
                        alert(data.message);
                        return;
                      default:
                        alert("网络异常");
                        return;
                    }
                 },
        error: function(data){
                    alert("服务器出现未知错误");
                 }
      });
    });
  });
</script>
</head>
<body id="login">
  <div class="login-logo" style="padding-top:200px">
    <h2>虚拟宠物医院管理系统</h2>
  </div>
  <h2 class="form-heading" style="color:white">登陆</h2>
  <div class="app-cam">
	  <form class="form-horizontal" id="login_form">
		<input type="text" name="username" class="text" placeholder="请输入用户名" value="">
		<input type="password" name="password" placeholder="请输入密码" value="">
		<div class="form-group" style>
      <div class="col-sm-12">
        <div class="radio-inline"><label><input name="is_manager" type="radio" value="false" checked="checked"> 实习生 </label></div>
        <div class="radio-inline"><label><input name="is_manager" type="radio" value="true"> 管理员 </label></div>
      </div>
    </div>
    <div class="submit"><input type="submit" id="login_button" value="登陆"></div>
    
		<ul class="new">
			<li class="new_left"><p><a href="#">忘记密码 ?</a></p></li>
			<li class="new_right"><p class="sign">新会员 ?<a href="register.html"> 注册</a></p></li>
			<div class="clearfix"></div>
		</ul>
	</form>
  </div>
   <div class="copy_layout login">
      <p>Copyright © 2017. All Rights Reserved | Design by <a href="" target="_blank">petclinic</a> </p>
   </div>

</body>
</html>
